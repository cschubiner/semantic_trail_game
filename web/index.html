<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Semantic Trail - Word Guessing Game</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>SEMANTIC TRAIL</h1>
      <p class="subtitle">Find the secret word using semantic similarity!</p>
    </header>

    <!-- Mode Toggle -->
    <div class="mode-toggle">
      <button id="mode-similarity" class="mode-btn active">Similarity</button>
      <button id="mode-questions" class="mode-btn">20 Questions</button>
    </div>

    <main>
      <!-- Status message area -->
      <div id="status" class="status"></div>

      <!-- Timer display (hidden until first guess) -->
      <div id="timer-display" class="timer-display hidden">
        <div class="timer-main">
          <span id="timer-time" class="timer-time">0:00</span>
          <span id="timer-tier" class="timer-tier">ðŸ§  Genius</span>
        </div>
        <div class="timer-progress-container">
          <div id="timer-progress" class="timer-progress-bar"></div>
        </div>
        <div id="timer-next-tier" class="timer-next-tier">3:00 until Brilliant</div>
      </div>

      <!-- Win banner (hidden by default) -->
      <div id="win-banner" class="win-banner hidden">
        <h2>Congratulations!</h2>
        <p>You found the word: <span id="win-word"></span></p>
        <p>Guesses: <span id="win-guesses"></span> | Time: <span id="win-time"></span></p>
        <p id="win-tier" class="win-tier"></p>
        <div class="win-buttons">
          <button onclick="resetGame()">Play Again</button>
          <button onclick="newRandomGame()" class="new-word-btn">New Word</button>
        </div>
      </div>

      <!-- Input area -->
      <div class="input-area">
        <input
          type="text"
          id="guess-input"
          placeholder="Type your guess..."
          autocomplete="off"
          autocapitalize="off"
          spellcheck="false"
        />
        <button id="guess-btn" onclick="submitGuess()">Guess</button>
        <button id="mic-btn" title="Voice input (Web Speech)">
          <span class="mic-icon">&#x1F399;</span>
        </button>
        <button id="transcribe-record-btn" class="transcribe-record-btn" title="GPT-4o transcribe (continuous)">
          <span class="record-icon">&#x23FA;</span>
        </button>
      </div>

      <!-- Mic status -->
      <div id="mic-status" class="mic-status hidden">Listening...</div>

      <!-- Transcribe status (Similarity Mode) -->
      <div id="transcribe-status" class="transcribe-status hidden">
        <div class="transcribe-indicator" id="transcribe-indicator"></div>
        <span id="transcribe-status-text">Recording...</span>
      </div>

      <!-- Hint/Reveal buttons -->
      <div class="hint-buttons">
        <button id="hint-letter-btn" class="hint-btn" title="Show first letter (+1 min)">
          Hint: First Letter
        </button>
        <button id="hint-length-btn" class="hint-btn" title="Show word length (+1 min)">
          Hint: Word Length
        </button>
        <button id="hint-llm-btn" class="hint-btn" title="Get a vague hint from AI (+2 min)">
          Hint: LLM
        </button>
        <button id="reveal-btn" class="reveal-btn" title="Give up and reveal the word">
          Give Up
        </button>
        <button id="new-word-btn" class="new-word-btn" onclick="newRandomGame()" title="Start a new game with a different word">
          New Word
        </button>
      </div>

      <!-- Hint display -->
      <div id="hint-display" class="hint-display hidden"></div>

      <!-- Recent guesses -->
      <div id="recent-guesses" class="recent-guesses hidden">
        <span class="recent-label">Recent:</span>
        <div id="recent-list" class="recent-list"></div>
      </div>

      <!-- Guess history table -->
      <div class="guess-table-container">
        <table id="guess-table" class="guess-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Word</th>
              <th>Score</th>
              <th>LLM</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="guess-tbody">
            <!-- Guesses will be inserted here -->
          </tbody>
        </table>
        <p id="no-guesses" class="no-guesses">No guesses yet. Start typing!</p>
      </div>

      <!-- Help/commands (Similarity mode) -->
      <div id="similarity-help" class="help-section">
        <p><strong>How to play:</strong> Guess a word. You'll see a score (0-100) based on semantic similarity.</p>
        <p>Higher scores mean you're closer to the secret word!</p>
        <div class="bucket-legend">
          <span class="bucket burning">BURNING (95+)</span>
          <span class="bucket hot">Hot (80-94)</span>
          <span class="bucket warm">Warm (60-79)</span>
          <span class="bucket tepid">Tepid (40-59)</span>
          <span class="bucket cold">Cold (20-39)</span>
          <span class="bucket freezing">Freezing (0-19)</span>
        </div>
      </div>

      <!-- ===================== QUESTIONS MODE ===================== -->
      <div id="questions-container" class="questions-container hidden">
        <!-- Audio Recording Status -->
        <div id="audio-status" class="audio-status">
          <div class="audio-indicator" id="audio-indicator"></div>
          <span id="audio-status-text">Click to start recording</span>
        </div>

        <!-- Audio Control Button -->
        <button id="audio-record-btn" class="audio-record-btn">
          <span class="record-icon">&#x23FA;</span>
          Start Recording
        </button>

        <!-- Question Text Input -->
        <div class="question-input-area">
          <input
            type="text"
            id="question-input"
            placeholder="Type your question (e.g., Is it alive?)"
            autocomplete="off"
          />
          <button id="ask-btn">Ask</button>
        </div>

        <!-- Transcription Preview -->
        <div id="transcription-preview" class="transcription-preview hidden">
          <span class="preview-label">Heard:</span>
          <span id="transcription-text"></span>
        </div>

        <!-- Q&A History -->
        <div class="qa-history-container">
          <div id="qa-history" class="qa-history">
            <p id="no-questions" class="no-questions">No questions yet. Start asking!</p>
          </div>
        </div>

        <!-- Question Count -->
        <div class="question-count">
          Questions asked: <span id="question-count">0</span>
        </div>

        <!-- Hint button for Questions mode -->
        <div class="questions-hint-buttons">
          <button id="questions-hint-btn" class="hint-btn" title="Get a vague hint from AI (+2 min)">
            Hint: LLM
          </button>
        </div>

        <!-- Questions Hint display -->
        <div id="questions-hint-display" class="hint-display hidden"></div>

        <!-- Help section for Questions mode -->
        <div class="help-section questions-help">
          <p><strong>How to play:</strong> Ask yes/no questions to guess the secret word (like 20 Questions).</p>
          <p>You can speak questions into the microphone or type them.</p>
          <p>When you think you know the answer, ask "Is it [word]?"</p>
          <div class="answer-legend">
            <span class="answer-tag answer-yes">YES</span>
            <span class="answer-tag answer-no">NO</span>
            <span class="answer-tag answer-maybe">MAYBE</span>
            <span class="answer-tag answer-close">SO CLOSE</span>
            <span class="answer-tag answer-na">N/A</span>
          </div>
        </div>
      </div>
      <!-- ===================== END QUESTIONS MODE ===================== -->
    </main>

    <footer>
      <p>Powered by <a href="https://openrouter.ai/" target="_blank">OpenRouter</a> embeddings</p>
    </footer>
  </div>

  <script src="game.js"></script>
</body>
</html>
